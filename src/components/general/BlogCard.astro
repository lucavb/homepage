---
import { IBlogPostCard } from '@types';
import BlogThumbnail from './BlogThumbnail.astro';

const { blogPost } = Astro.props as IBlogPostCard;
const { id, title, description, publishDate, tags, thumbnail, heroImagePath } = blogPost;

const formatDate = (date: Date) => {
    return new Intl.DateTimeFormat('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
    }).format(date);
};
---

<article
    class="text-center p-6 bg-gray-50 dark:bg-gray-800 rounded-lg hover:shadow-lg transition-all duration-300 group"
>
    <div
        class="h-48 bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-700 dark:to-gray-600 rounded-lg mb-4 flex items-center justify-center overflow-hidden"
    >
        <BlogThumbnail thumbnail={thumbnail} heroImagePath={heroImagePath} title={title} />
    </div>
    <div class="flex items-center justify-center text-xs text-gray-500 dark:text-gray-400 mb-3">
        <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
        </svg>
        {formatDate(publishDate)}
    </div>
    <h4
        class="font-semibold text-gray-900 dark:text-white mb-3 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors"
    >
        <a
            href={`/blog/${id}`}
            class="hover:no-underline"
            onclick={`_paq && _paq.push(['trackEvent', 'Blog', 'Post Click', '${title}']);`}
        >
            {title}
        </a>
    </h4>
    <p class="text-gray-600 dark:text-gray-300 text-sm mb-4">
        {description.length > 120 ? description.substring(0, 120) + '...' : description}
    </p>
    {
        tags && tags.length > 0 && (
            <div class="flex flex-wrap justify-center gap-1 mb-4">
                {tags.slice(0, 2).map((tag) => (
                    <span class="px-2 py-1 text-xs font-medium bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded-full">
                        {tag}
                    </span>
                ))}
            </div>
        )
    }
</article>
